# シフト表自動作成アプリ v3.0 — デプロイ手順書

## 🖥️ 方法1: Render（無料クラウド）でWebアプリとして公開

Pythonなしで、社内PCのブラウザからアクセスできます。

### 手順

1. **GitHubリポジトリを作成**
   - [github.com](https://github.com) でアカウントを作成（無料）
   - 新しいリポジトリを作成し、以下のファイルをアップロード:
     - `main.py`
     - `requirements.txt`
     - `render.yaml`

2. **Renderにデプロイ**
   - [render.com](https://render.com) でアカウントを作成（無料）
   - 「New +」→「Web Service」→ GitHubリポジトリを接続
   - **Build Command**: `pip install -r requirements.txt`
   - **Start Command**: `uvicorn main:app --host 0.0.0.0 --port $PORT`
   - 「Create Web Service」をクリック

3. **URLにアクセス**
   - デプロイ完了後に表示されるURL（例: `https://shift-app-xxxx.onrender.com`）を
     社内PCのブラウザで開く

> ⚠️ **注意**: 無料プランは15分間アクセスがないとスリープします。
> 初回アクセス時に30〜60秒かかる場合があります。

---

## 🐳 方法2: Docker（社内サーバー等）で起動

```bash
docker build -t shift-app .
docker run -p 8000:8000 shift-app
```
→ ブラウザで `http://サーバーIP:8000` にアクセス

---

## 💻 方法3: Python環境があるPCで直接起動

```bash
pip install -r requirements.txt
python main.py
```
→ ブラウザが自動で開きます

Windowsなら `start.bat` をダブルクリックするだけです。

---

## 📋 必要なExcelシート構成

| シート名 | 内容 |
|---------|------|
| Staff_Master | 職員名・契約区分・ユニット・夜勤最少/最高・備考・固定公休 |
| Settings | 勤務期間・公休日数・シフト種別 |
| Shift_Requests | 希望休・勤務指定 |
| Prev_Month | 前月シフト実績 |
| shift_result | 出力先（空でOK） |

### Staff_Master の備考欄の書き方

| 記入例 | 効果 |
|--------|------|
| `早出のみ。週4日勤務。` | 早出のみ・週4日 |
| `週5日勤務。` | 全シフト可・週5日 |
| `夜勤なし。` | 夜勤を割り当てない |
| `早出のみ。` | 早出以外を割り当てない |

### Staff_Master の固定公休欄の書き方

| 記入例 | 効果 |
|--------|------|
| `日曜` | 毎週日曜を公休に |
| `土・日` | 毎週土日を公休に |
| `月` | 毎週月曜を公休に |

---

## 🔒 適用される制約（v3.0）

1. ユニットA・B 毎日早出1名・遅出1名
2. 夜勤：毎日1名（個人の最少〜最高を厳守）
3. 40h→最大5連勤、32h・パート→最大4連勤
4. 夜勤→翌日×、遅出→翌日早出禁止
5. 希望休の前日夜勤禁止
6. **パート職員に有給を自動割り当てしない**
7. 備考の勤務制限を厳守（早出のみ等）
8. **固定公休（曜日）を考慮**
9. パート職員の週単位勤務日数管理
10. 希望・指定をExcelで色分け
